{"ast":null,"code":"import { updatePair, getPairs, getMatches, getGames } from \"../lib/database\";\nexport class MatchResultCalculator {\n  /**\n   * Calcula estad√≠sticas de un partido\n   */\n  static calculateMatchStatistics(match, games) {\n    console.log(\"üéØ === C√ÅLCULO DE ESTAD√çSTICAS ===\");\n    console.log(\"üéØ Partido ID:\", match.id);\n    console.log(\"üéØ Total de juegos:\", games.length);\n    let pair1GamesWon = 0;\n    let pair2GamesWon = 0;\n    let pair1TotalPoints = 0;\n    let pair2TotalPoints = 0;\n    let pair1SetsWon = 0;\n    let pair2SetsWon = 0;\n\n    // Procesar cada juego\n    games.forEach((game, index) => {\n      console.log(`üìä === JUEGO ${index + 1} ===`);\n      console.log(\"üìä Datos del juego:\", JSON.stringify(game, null, 2));\n      if (game.is_tie_break) {\n        console.log(\"üìä Es un tie-break\");\n        // Para tie-breaks\n        if (game.tie_break_pair1_points > game.tie_break_pair2_points) {\n          pair1GamesWon++;\n          console.log(`‚úÖ Pareja 1 gana tie-break: ${game.tie_break_pair1_points}-${game.tie_break_pair2_points}`);\n        } else if (game.tie_break_pair2_points > game.tie_break_pair1_points) {\n          pair2GamesWon++;\n          console.log(`‚úÖ Pareja 2 gana tie-break: ${game.tie_break_pair1_points}-${game.tie_break_pair2_points}`);\n        } else {\n          console.log(`ü§ù Empate en tie-break: ${game.tie_break_pair1_points}-${game.tie_break_pair2_points}`);\n        }\n        pair1TotalPoints += game.tie_break_pair1_points;\n        pair2TotalPoints += game.tie_break_pair2_points;\n      } else {\n        console.log(\"üìä Es un juego normal\");\n        console.log(`üìä Puntos Pareja 1: ${game.pair1_games}, Puntos Pareja 2: ${game.pair2_games}`);\n\n        // Para juegos normales\n        if (game.pair1_games > game.pair2_games) {\n          pair1GamesWon++;\n          console.log(`‚úÖ Pareja 1 gana juego: ${game.pair1_games}-${game.pair2_games}`);\n        } else if (game.pair2_games > game.pair1_games) {\n          pair2GamesWon++;\n          console.log(`‚úÖ Pareja 2 gana juego: ${game.pair1_games}-${game.pair2_games}`);\n        } else {\n          console.log(`ü§ù Empate en juego: ${game.pair1_games}-${game.pair2_games}`);\n        }\n        pair1TotalPoints += game.pair1_games;\n        pair2TotalPoints += game.pair2_games;\n      }\n\n      // Verificar si alguna pareja lleg√≥ a 6 puntos en este juego (gana 1 set)\n      if (!game.is_tie_break) {\n        // La pareja que llegue a 6 puntos gana 1 set (sin importar el marcador del oponente)\n        if (game.pair1_games >= 6) {\n          pair1SetsWon++;\n          console.log(`üèÜ Pareja 1 gana 1 SET en juego ${index + 1} con ${game.pair1_games} puntos`);\n        }\n        if (game.pair2_games >= 6) {\n          pair2SetsWon++;\n          console.log(`üèÜ Pareja 2 gana 1 SET en juego ${index + 1} con ${game.pair2_games} puntos`);\n        }\n      }\n      console.log(`üìä Despu√©s del juego ${index + 1}: Pareja 1 = ${pair1GamesWon} juegos, Pareja 2 = ${pair2GamesWon} juegos`);\n    });\n    console.log(\"üîç === RESULTADO FINAL ===\");\n    console.log(`üîç Juegos: Pareja 1 = ${pair1GamesWon}, Pareja 2 = ${pair2GamesWon}`);\n    console.log(`üîç Sets: Pareja 1 = ${pair1SetsWon}, Pareja 2 = ${pair2SetsWon}`);\n    console.log(`üîç Puntos totales: Pareja 1 = ${pair1TotalPoints}, Pareja 2 = ${pair2TotalPoints}`);\n\n    // Determinar si es empate (cuando los puntos totales son iguales)\n    const isTie = pair1TotalPoints === pair2TotalPoints;\n    console.log(`üîç Es empate: ${isTie} (${pair1TotalPoints}-${pair2TotalPoints} puntos totales)`);\n    console.log(\"üéØ === FIN C√ÅLCULO ===\");\n    return {\n      pair1GamesWon,\n      pair2GamesWon,\n      pair1SetsWon,\n      pair2SetsWon,\n      pair1TotalPoints,\n      pair2TotalPoints,\n      isTie\n    };\n  }\n\n  /**\n   * Actualiza estad√≠sticas de un partido espec√≠fico\n   */\n  static async updateMatchStatistics(match, games, pairs, shouldAccumulate = true) {\n    try {\n      console.log(\"üîÑ === INICIO ACTUALIZACI√ìN ===\");\n      const stats = this.calculateMatchStatistics(match, games);\n      const pair1 = pairs.find(p => p.id === match.pair1_id);\n      const pair2 = pairs.find(p => p.id === match.pair2_id);\n      console.log(\"üìä Actualizando estad√≠sticas del partido:\", {\n        pair1GamesWon: stats.pair1GamesWon,\n        pair2GamesWon: stats.pair2GamesWon,\n        pair1SetsWon: stats.pair1SetsWon,\n        pair2SetsWon: stats.pair2SetsWon,\n        isTie: stats.isTie\n      });\n\n      // ACTUALIZAR ESTAD√çSTICAS EN LA BASE DE DATOS\n      if (pair1) {\n        var _pair1$player, _pair1$player2;\n        console.log(`üìä Actualizando Pareja 1: ${(_pair1$player = pair1.player1) === null || _pair1$player === void 0 ? void 0 : _pair1$player.name} y ${(_pair1$player2 = pair1.player2) === null || _pair1$player2 === void 0 ? void 0 : _pair1$player2.name}`);\n        console.log(`üìä Estad√≠sticas actuales: ${pair1.games_won} juegos, ${pair1.sets_won} sets, ${pair1.points} puntos, ${pair1.matches_played} partidos`);\n        console.log(`üìä Estad√≠sticas del partido: ${stats.pair1GamesWon} juegos, ${stats.pair1SetsWon} sets, ${stats.pair1TotalPoints} puntos`);\n        console.log(`üìä Modo: ${shouldAccumulate ? 'Acumular' : 'Solo recalcular'}`);\n        if (shouldAccumulate) {\n          // ACUMULAR estad√≠sticas (solo al finalizar partido)\n          await updatePair(pair1.id, {\n            games_won: pair1.games_won + stats.pair1GamesWon,\n            sets_won: pair1.sets_won + stats.pair1SetsWon,\n            points: pair1.points + stats.pair1TotalPoints,\n            matches_played: pair1.matches_played + 1\n          });\n          console.log(`‚úÖ Pareja 1 actualizada (ACUMULADO): ${pair1.games_won + stats.pair1GamesWon} juegos, ${pair1.sets_won + stats.pair1SetsWon} sets, ${pair1.points + stats.pair1TotalPoints} puntos, ${pair1.matches_played + 1} partidos`);\n        } else {\n          // SOLO RECALCULAR estad√≠sticas (al corregir juegos)\n          console.log(`‚úÖ Pareja 1: Solo rec√°lculo de estad√≠sticas (sin acumular)`);\n        }\n      }\n      if (pair2) {\n        var _pair2$player, _pair2$player2;\n        console.log(`üìä Actualizando Pareja 2: ${(_pair2$player = pair2.player1) === null || _pair2$player === void 0 ? void 0 : _pair2$player.name} y ${(_pair2$player2 = pair2.player2) === null || _pair2$player2 === void 0 ? void 0 : _pair2$player2.name}`);\n        console.log(`üìä Estad√≠sticas actuales: ${pair2.games_won} juegos, ${pair2.sets_won} sets, ${pair2.points} puntos, ${pair2.matches_played} partidos`);\n        console.log(`üìä Estad√≠sticas del partido: ${stats.pair2GamesWon} juegos, ${stats.pair2SetsWon} sets, ${stats.pair2TotalPoints} puntos`);\n        console.log(`üìä Modo: ${shouldAccumulate ? 'Acumular' : 'Solo recalcular'}`);\n        if (shouldAccumulate) {\n          // ACUMULAR estad√≠sticas (solo al finalizar partido)\n          await updatePair(pair2.id, {\n            games_won: pair2.games_won + stats.pair2GamesWon,\n            sets_won: pair2.sets_won + stats.pair2SetsWon,\n            points: pair2.points + stats.pair2TotalPoints,\n            matches_played: pair2.matches_played + 1\n          });\n          console.log(`‚úÖ Pareja 2 actualizada (ACUMULADO): ${pair2.games_won + stats.pair2GamesWon} juegos, ${pair2.sets_won + stats.pair2SetsWon} sets, ${pair2.points + stats.pair2TotalPoints} puntos, ${pair2.matches_played + 1} partidos`);\n        } else {\n          // SOLO RECALCULAR estad√≠sticas (al corregir juegos)\n          console.log(`‚úÖ Pareja 2: Solo rec√°lculo de estad√≠sticas (sin acumular)`);\n        }\n      }\n\n      // Determinar ganador\n      let winnerId;\n      console.log(\"üèÜ === DETERMINACI√ìN DEL GANADOR ===\");\n      console.log(`üèÜ Sets: Pareja 1 = ${stats.pair1SetsWon}, Pareja 2 = ${stats.pair2SetsWon}`);\n      console.log(`üèÜ Juegos: Pareja 1 = ${stats.pair1GamesWon}, Pareja 2 = ${stats.pair2GamesWon}`);\n      console.log(`üèÜ Es empate: ${stats.isTie}`);\n      if (stats.isTie) {\n        // Es un empate por puntos totales\n        winnerId = undefined;\n        console.log(\"ü§ù Partido termin√≥ en EMPATE por puntos totales\");\n      } else if (stats.pair1TotalPoints > stats.pair2TotalPoints) {\n        // Pareja 1 tiene m√°s puntos totales\n        winnerId = match.pair1_id;\n        console.log(\"üèÜ Pareja 1 gana por puntos totales\");\n      } else if (stats.pair2TotalPoints > stats.pair1TotalPoints) {\n        // Pareja 2 tiene m√°s puntos totales\n        winnerId = match.pair2_id;\n        console.log(\"üèÜ Pareja 2 gana por puntos totales\");\n      } else {\n        // Caso inesperado\n        winnerId = undefined;\n        console.log(\"‚ùå Caso inesperado en determinaci√≥n del ganador\");\n      }\n      let message;\n      if (stats.isTie) {\n        message = `‚úÖ Partido finalizado.\\n\\nü§ù EMPATE (${stats.pair1TotalPoints}-${stats.pair2TotalPoints} puntos totales)`;\n      } else if (winnerId) {\n        var _pair1$player3, _pair1$player4, _pair2$player3, _pair2$player4;\n        const winnerName = winnerId === match.pair1_id ? `${pair1 === null || pair1 === void 0 ? void 0 : (_pair1$player3 = pair1.player1) === null || _pair1$player3 === void 0 ? void 0 : _pair1$player3.name} y ${pair1 === null || pair1 === void 0 ? void 0 : (_pair1$player4 = pair1.player2) === null || _pair1$player4 === void 0 ? void 0 : _pair1$player4.name}` : `${pair2 === null || pair2 === void 0 ? void 0 : (_pair2$player3 = pair2.player1) === null || _pair2$player3 === void 0 ? void 0 : _pair2$player3.name} y ${pair2 === null || pair2 === void 0 ? void 0 : (_pair2$player4 = pair2.player2) === null || _pair2$player4 === void 0 ? void 0 : _pair2$player4.name}`;\n        message = `‚úÖ Partido finalizado.\\n\\nüèÜ Ganador: ${winnerName} (${stats.pair1TotalPoints}-${stats.pair2TotalPoints} puntos totales)`;\n      } else {\n        message = `‚úÖ Partido finalizado.\\n\\nü§ù Empate (${stats.pair1TotalPoints}-${stats.pair2TotalPoints} puntos totales)`;\n      }\n      console.log(\"üîÑ === FIN ACTUALIZACI√ìN ===\");\n      return {\n        success: true,\n        message,\n        pair1Stats: {\n          gamesWon: stats.pair1GamesWon,\n          setsWon: stats.pair1SetsWon,\n          points: stats.pair1TotalPoints\n        },\n        pair2Stats: {\n          gamesWon: stats.pair2GamesWon,\n          setsWon: stats.pair2SetsWon,\n          points: stats.pair2TotalPoints\n        },\n        winnerId,\n        isTie: stats.isTie\n      };\n    } catch (error) {\n      console.error(\"‚ùå Error en updateMatchStatistics:\", error);\n      return {\n        success: false,\n        message: \"Error al actualizar estad√≠sticas del partido\",\n        pair1Stats: {\n          gamesWon: 0,\n          setsWon: 0,\n          points: 0\n        },\n        pair2Stats: {\n          gamesWon: 0,\n          setsWon: 0,\n          points: 0\n        },\n        isTie: false\n      };\n    }\n  }\n\n  /**\n   * Recalcula todas las estad√≠sticas del torneo\n   */\n  static async recalculateAllStatistics(tournamentId) {\n    try {\n      console.log(\"üîÑ === INICIO REC√ÅLCULO ===\");\n\n      // Obtener todos los datos del torneo\n      const pairs = await getPairs(tournamentId);\n      const matches = await getMatches(tournamentId);\n\n      // Resetear todas las estad√≠sticas de las parejas\n      console.log(\"üîÑ Reseteando estad√≠sticas de todas las parejas...\");\n      for (const pair of pairs) {\n        await updatePair(pair.id, {\n          games_won: 0,\n          sets_won: 0,\n          points: 0,\n          matches_played: 0\n        });\n      }\n\n      // Crear un mapa para acumular estad√≠sticas de cada pareja\n      const pairStats = new Map();\n\n      // Inicializar estad√≠sticas para todas las parejas\n      for (const pair of pairs) {\n        pairStats.set(pair.id, {\n          gamesWon: 0,\n          setsWon: 0,\n          points: 0,\n          matchesPlayed: 0\n        });\n      }\n\n      // Procesar cada partido finalizado y acumular estad√≠sticas\n      let processedMatches = 0;\n      for (const match of matches) {\n        if (match.is_finished) {\n          console.log(`üîÑ Procesando partido: ${match.id}`);\n          const games = await getGames(match.id);\n          if (games.length > 0) {\n            const stats = this.calculateMatchStatistics(match, games);\n\n            // Acumular estad√≠sticas para pareja 1\n            const pair1Stats = pairStats.get(match.pair1_id);\n            pair1Stats.gamesWon += stats.pair1GamesWon;\n            pair1Stats.setsWon += stats.pair1SetsWon;\n            pair1Stats.points += stats.pair1TotalPoints;\n            pair1Stats.matchesPlayed += 1;\n\n            // Acumular estad√≠sticas para pareja 2\n            const pair2Stats = pairStats.get(match.pair2_id);\n            pair2Stats.gamesWon += stats.pair2GamesWon;\n            pair2Stats.setsWon += stats.pair2SetsWon;\n            pair2Stats.points += stats.pair2TotalPoints;\n            pair2Stats.matchesPlayed += 1;\n            processedMatches++;\n          }\n        }\n      }\n\n      // Actualizar todas las parejas con sus estad√≠sticas acumuladas\n      console.log(\"üîÑ Actualizando estad√≠sticas acumuladas...\");\n      for (const pair of pairs) {\n        const stats = pairStats.get(pair.id);\n        if (stats) {\n          await updatePair(pair.id, {\n            games_won: stats.gamesWon,\n            sets_won: stats.setsWon,\n            points: stats.points,\n            matches_played: stats.matchesPlayed\n          });\n          console.log(`üìä Pareja ${pair.id}: ${stats.points} puntos, ${stats.setsWon} sets, ${stats.gamesWon} juegos`);\n        }\n      }\n      console.log(`‚úÖ Estad√≠sticas recalculadas para ${processedMatches} partidos`);\n      console.log(\"üîÑ === FIN REC√ÅLCULO ===\");\n      return {\n        success: true,\n        message: `‚úÖ Estad√≠sticas recalculadas exitosamente para ${processedMatches} partidos`\n      };\n    } catch (error) {\n      console.error(\"‚ùå Error en recalculateAllStatistics:\", error);\n      return {\n        success: false,\n        message: \"Error al recalcular estad√≠sticas del torneo\"\n      };\n    }\n  }\n\n  /**\n   * Calcula el ranking de las parejas\n   */\n  static calculateRanking(pairs) {\n    return [...pairs].sort((a, b) => {\n      // Criterio 1: Puntos totales (descendente) - CRITERIO PRINCIPAL\n      if (a.points !== b.points) {\n        return b.points - a.points;\n      }\n      // Criterio 2: Sets ganados (descendente) - CRITERIO DE DESEMPATE\n      if (a.sets_won !== b.sets_won) {\n        return b.sets_won - a.sets_won;\n      }\n      // Criterio 3: Juegos ganados (descendente)\n      if (a.games_won !== b.games_won) {\n        return b.games_won - a.games_won;\n      }\n      // Criterio 4: Menos partidos jugados (mejor eficiencia)\n      return a.matches_played - b.matches_played;\n    });\n  }\n}","map":{"version":3,"names":["updatePair","getPairs","getMatches","getGames","MatchResultCalculator","calculateMatchStatistics","match","games","console","log","id","length","pair1GamesWon","pair2GamesWon","pair1TotalPoints","pair2TotalPoints","pair1SetsWon","pair2SetsWon","forEach","game","index","JSON","stringify","is_tie_break","tie_break_pair1_points","tie_break_pair2_points","pair1_games","pair2_games","isTie","updateMatchStatistics","pairs","shouldAccumulate","stats","pair1","find","p","pair1_id","pair2","pair2_id","_pair1$player","_pair1$player2","player1","name","player2","games_won","sets_won","points","matches_played","_pair2$player","_pair2$player2","winnerId","undefined","message","_pair1$player3","_pair1$player4","_pair2$player3","_pair2$player4","winnerName","success","pair1Stats","gamesWon","setsWon","pair2Stats","error","recalculateAllStatistics","tournamentId","matches","pair","pairStats","Map","set","matchesPlayed","processedMatches","is_finished","get","calculateRanking","sort","a","b"],"sources":["/Users/nedev/padel-tournament-app/src/components/MatchResultCalculator.tsx"],"sourcesContent":["import { Game, Match, Pair } from \"../lib/database\";\nimport { updatePair, getPairs, getMatches, getGames } from \"../lib/database\";\n\nexport interface MatchResult {\n  success: boolean;\n  message: string;\n  pair1Stats: {\n    gamesWon: number;\n    setsWon: number;\n    points: number;\n  };\n  pair2Stats: {\n    gamesWon: number;\n    setsWon: number;\n    points: number;\n  };\n  winnerId?: string;\n  isTie: boolean;\n}\n\nexport class MatchResultCalculator {\n  /**\n   * Calcula estad√≠sticas de un partido\n   */\n  static calculateMatchStatistics(\n    match: Match,\n    games: Game[]\n  ): {\n    pair1GamesWon: number;\n    pair2GamesWon: number;\n    pair1SetsWon: number;\n    pair2SetsWon: number;\n    pair1TotalPoints: number;\n    pair2TotalPoints: number;\n    isTie: boolean;\n  } {\n    console.log(\"üéØ === C√ÅLCULO DE ESTAD√çSTICAS ===\");\n    console.log(\"üéØ Partido ID:\", match.id);\n    console.log(\"üéØ Total de juegos:\", games.length);\n\n    let pair1GamesWon = 0;\n    let pair2GamesWon = 0;\n    let pair1TotalPoints = 0;\n    let pair2TotalPoints = 0;\n    let pair1SetsWon = 0;\n    let pair2SetsWon = 0;\n\n    // Procesar cada juego\n    games.forEach((game, index) => {\n      console.log(`üìä === JUEGO ${index + 1} ===`);\n      console.log(\"üìä Datos del juego:\", JSON.stringify(game, null, 2));\n\n      if (game.is_tie_break) {\n        console.log(\"üìä Es un tie-break\");\n        // Para tie-breaks\n        if (game.tie_break_pair1_points > game.tie_break_pair2_points) {\n          pair1GamesWon++;\n          console.log(\n            `‚úÖ Pareja 1 gana tie-break: ${game.tie_break_pair1_points}-${game.tie_break_pair2_points}`\n          );\n        } else if (game.tie_break_pair2_points > game.tie_break_pair1_points) {\n          pair2GamesWon++;\n          console.log(\n            `‚úÖ Pareja 2 gana tie-break: ${game.tie_break_pair1_points}-${game.tie_break_pair2_points}`\n          );\n        } else {\n          console.log(\n            `ü§ù Empate en tie-break: ${game.tie_break_pair1_points}-${game.tie_break_pair2_points}`\n          );\n        }\n        pair1TotalPoints += game.tie_break_pair1_points;\n        pair2TotalPoints += game.tie_break_pair2_points;\n      } else {\n        console.log(\"üìä Es un juego normal\");\n        console.log(\n          `üìä Puntos Pareja 1: ${game.pair1_games}, Puntos Pareja 2: ${game.pair2_games}`\n        );\n\n        // Para juegos normales\n        if (game.pair1_games > game.pair2_games) {\n          pair1GamesWon++;\n          console.log(\n            `‚úÖ Pareja 1 gana juego: ${game.pair1_games}-${game.pair2_games}`\n          );\n        } else if (game.pair2_games > game.pair1_games) {\n          pair2GamesWon++;\n          console.log(\n            `‚úÖ Pareja 2 gana juego: ${game.pair1_games}-${game.pair2_games}`\n          );\n        } else {\n          console.log(\n            `ü§ù Empate en juego: ${game.pair1_games}-${game.pair2_games}`\n          );\n        }\n        pair1TotalPoints += game.pair1_games;\n        pair2TotalPoints += game.pair2_games;\n      }\n\n      // Verificar si alguna pareja lleg√≥ a 6 puntos en este juego (gana 1 set)\n      if (!game.is_tie_break) {\n        // La pareja que llegue a 6 puntos gana 1 set (sin importar el marcador del oponente)\n        if (game.pair1_games >= 6) {\n          pair1SetsWon++;\n          console.log(\n            `üèÜ Pareja 1 gana 1 SET en juego ${index + 1} con ${\n              game.pair1_games\n            } puntos`\n          );\n        }\n        if (game.pair2_games >= 6) {\n          pair2SetsWon++;\n          console.log(\n            `üèÜ Pareja 2 gana 1 SET en juego ${index + 1} con ${\n              game.pair2_games\n            } puntos`\n          );\n        }\n      }\n\n      console.log(\n        `üìä Despu√©s del juego ${\n          index + 1\n        }: Pareja 1 = ${pair1GamesWon} juegos, Pareja 2 = ${pair2GamesWon} juegos`\n      );\n    });\n\n    console.log(\"üîç === RESULTADO FINAL ===\");\n    console.log(\n      `üîç Juegos: Pareja 1 = ${pair1GamesWon}, Pareja 2 = ${pair2GamesWon}`\n    );\n    console.log(\n      `üîç Sets: Pareja 1 = ${pair1SetsWon}, Pareja 2 = ${pair2SetsWon}`\n    );\n    console.log(\n      `üîç Puntos totales: Pareja 1 = ${pair1TotalPoints}, Pareja 2 = ${pair2TotalPoints}`\n    );\n\n    // Determinar si es empate (cuando los puntos totales son iguales)\n    const isTie = pair1TotalPoints === pair2TotalPoints;\n    console.log(\n      `üîç Es empate: ${isTie} (${pair1TotalPoints}-${pair2TotalPoints} puntos totales)`\n    );\n\n    console.log(\"üéØ === FIN C√ÅLCULO ===\");\n\n    return {\n      pair1GamesWon,\n      pair2GamesWon,\n      pair1SetsWon,\n      pair2SetsWon,\n      pair1TotalPoints,\n      pair2TotalPoints,\n      isTie,\n    };\n  }\n\n  /**\n   * Actualiza estad√≠sticas de un partido espec√≠fico\n   */\n  static async updateMatchStatistics(\n    match: Match,\n    games: Game[],\n    pairs: Pair[],\n    shouldAccumulate: boolean = true\n  ): Promise<MatchResult> {\n    try {\n      console.log(\"üîÑ === INICIO ACTUALIZACI√ìN ===\");\n\n      const stats = this.calculateMatchStatistics(match, games);\n      const pair1 = pairs.find((p) => p.id === match.pair1_id);\n      const pair2 = pairs.find((p) => p.id === match.pair2_id);\n\n      console.log(\"üìä Actualizando estad√≠sticas del partido:\", {\n        pair1GamesWon: stats.pair1GamesWon,\n        pair2GamesWon: stats.pair2GamesWon,\n        pair1SetsWon: stats.pair1SetsWon,\n        pair2SetsWon: stats.pair2SetsWon,\n        isTie: stats.isTie,\n      });\n\n            // ACTUALIZAR ESTAD√çSTICAS EN LA BASE DE DATOS\n      if (pair1) {\n        console.log(\n          `üìä Actualizando Pareja 1: ${pair1.player1?.name} y ${pair1.player2?.name}`\n        );\n        console.log(\n          `üìä Estad√≠sticas actuales: ${pair1.games_won} juegos, ${pair1.sets_won} sets, ${pair1.points} puntos, ${pair1.matches_played} partidos`\n        );\n        console.log(\n          `üìä Estad√≠sticas del partido: ${stats.pair1GamesWon} juegos, ${stats.pair1SetsWon} sets, ${stats.pair1TotalPoints} puntos`\n        );\n        console.log(`üìä Modo: ${shouldAccumulate ? 'Acumular' : 'Solo recalcular'}`);\n\n        if (shouldAccumulate) {\n          // ACUMULAR estad√≠sticas (solo al finalizar partido)\n          await updatePair(pair1.id, {\n            games_won: pair1.games_won + stats.pair1GamesWon,\n            sets_won: pair1.sets_won + stats.pair1SetsWon,\n            points: pair1.points + stats.pair1TotalPoints,\n            matches_played: pair1.matches_played + 1,\n          });\n \n          console.log(\n            `‚úÖ Pareja 1 actualizada (ACUMULADO): ${\n              pair1.games_won + stats.pair1GamesWon\n            } juegos, ${pair1.sets_won + stats.pair1SetsWon} sets, ${\n              pair1.points + stats.pair1TotalPoints\n            } puntos, ${pair1.matches_played + 1} partidos`\n          );\n        } else {\n          // SOLO RECALCULAR estad√≠sticas (al corregir juegos)\n          console.log(\n            `‚úÖ Pareja 1: Solo rec√°lculo de estad√≠sticas (sin acumular)`\n          );\n        }\n      }\n\n      if (pair2) {\n        console.log(\n          `üìä Actualizando Pareja 2: ${pair2.player1?.name} y ${pair2.player2?.name}`\n        );\n        console.log(\n          `üìä Estad√≠sticas actuales: ${pair2.games_won} juegos, ${pair2.sets_won} sets, ${pair2.points} puntos, ${pair2.matches_played} partidos`\n        );\n        console.log(\n          `üìä Estad√≠sticas del partido: ${stats.pair2GamesWon} juegos, ${stats.pair2SetsWon} sets, ${stats.pair2TotalPoints} puntos`\n        );\n        console.log(`üìä Modo: ${shouldAccumulate ? 'Acumular' : 'Solo recalcular'}`);\n\n        if (shouldAccumulate) {\n          // ACUMULAR estad√≠sticas (solo al finalizar partido)\n          await updatePair(pair2.id, {\n            games_won: pair2.games_won + stats.pair2GamesWon,\n            sets_won: pair2.sets_won + stats.pair2SetsWon,\n            points: pair2.points + stats.pair2TotalPoints,\n            matches_played: pair2.matches_played + 1,\n          });\n \n          console.log(\n            `‚úÖ Pareja 2 actualizada (ACUMULADO): ${\n              pair2.games_won + stats.pair2GamesWon\n            } juegos, ${pair2.sets_won + stats.pair2SetsWon} sets, ${\n              pair2.points + stats.pair2TotalPoints\n            } puntos, ${pair2.matches_played + 1} partidos`\n          );\n        } else {\n          // SOLO RECALCULAR estad√≠sticas (al corregir juegos)\n          console.log(\n            `‚úÖ Pareja 2: Solo rec√°lculo de estad√≠sticas (sin acumular)`\n          );\n        }\n      }\n\n      // Determinar ganador\n      let winnerId: string | undefined;\n\n      console.log(\"üèÜ === DETERMINACI√ìN DEL GANADOR ===\");\n      console.log(\n        `üèÜ Sets: Pareja 1 = ${stats.pair1SetsWon}, Pareja 2 = ${stats.pair2SetsWon}`\n      );\n      console.log(\n        `üèÜ Juegos: Pareja 1 = ${stats.pair1GamesWon}, Pareja 2 = ${stats.pair2GamesWon}`\n      );\n      console.log(`üèÜ Es empate: ${stats.isTie}`);\n\n      if (stats.isTie) {\n        // Es un empate por puntos totales\n        winnerId = undefined;\n        console.log(\"ü§ù Partido termin√≥ en EMPATE por puntos totales\");\n      } else if (stats.pair1TotalPoints > stats.pair2TotalPoints) {\n        // Pareja 1 tiene m√°s puntos totales\n        winnerId = match.pair1_id;\n        console.log(\"üèÜ Pareja 1 gana por puntos totales\");\n      } else if (stats.pair2TotalPoints > stats.pair1TotalPoints) {\n        // Pareja 2 tiene m√°s puntos totales\n        winnerId = match.pair2_id;\n        console.log(\"üèÜ Pareja 2 gana por puntos totales\");\n      } else {\n        // Caso inesperado\n        winnerId = undefined;\n        console.log(\"‚ùå Caso inesperado en determinaci√≥n del ganador\");\n      }\n\n      let message: string;\n      if (stats.isTie) {\n        message = `‚úÖ Partido finalizado.\\n\\nü§ù EMPATE (${stats.pair1TotalPoints}-${stats.pair2TotalPoints} puntos totales)`;\n      } else if (winnerId) {\n        const winnerName =\n          winnerId === match.pair1_id\n            ? `${pair1?.player1?.name} y ${pair1?.player2?.name}`\n            : `${pair2?.player1?.name} y ${pair2?.player2?.name}`;\n        message = `‚úÖ Partido finalizado.\\n\\nüèÜ Ganador: ${winnerName} (${stats.pair1TotalPoints}-${stats.pair2TotalPoints} puntos totales)`;\n      } else {\n        message = `‚úÖ Partido finalizado.\\n\\nü§ù Empate (${stats.pair1TotalPoints}-${stats.pair2TotalPoints} puntos totales)`;\n      }\n\n      console.log(\"üîÑ === FIN ACTUALIZACI√ìN ===\");\n\n      return {\n        success: true,\n        message,\n        pair1Stats: {\n          gamesWon: stats.pair1GamesWon,\n          setsWon: stats.pair1SetsWon,\n          points: stats.pair1TotalPoints,\n        },\n        pair2Stats: {\n          gamesWon: stats.pair2GamesWon,\n          setsWon: stats.pair2SetsWon,\n          points: stats.pair2TotalPoints,\n        },\n        winnerId,\n        isTie: stats.isTie,\n      };\n    } catch (error) {\n      console.error(\"‚ùå Error en updateMatchStatistics:\", error);\n      return {\n        success: false,\n        message: \"Error al actualizar estad√≠sticas del partido\",\n        pair1Stats: { gamesWon: 0, setsWon: 0, points: 0 },\n        pair2Stats: { gamesWon: 0, setsWon: 0, points: 0 },\n        isTie: false,\n      };\n    }\n  }\n\n  /**\n   * Recalcula todas las estad√≠sticas del torneo\n   */\n  static async recalculateAllStatistics(tournamentId: string): Promise<{\n    success: boolean;\n    message: string;\n  }> {\n    try {\n      console.log(\"üîÑ === INICIO REC√ÅLCULO ===\");\n\n      // Obtener todos los datos del torneo\n      const pairs = await getPairs(tournamentId);\n      const matches = await getMatches(tournamentId);\n\n      // Resetear todas las estad√≠sticas de las parejas\n      console.log(\"üîÑ Reseteando estad√≠sticas de todas las parejas...\");\n      for (const pair of pairs) {\n        await updatePair(pair.id, {\n          games_won: 0,\n          sets_won: 0,\n          points: 0,\n          matches_played: 0,\n        });\n      }\n\n      // Crear un mapa para acumular estad√≠sticas de cada pareja\n      const pairStats = new Map<\n        string,\n        {\n          gamesWon: number;\n          setsWon: number;\n          points: number;\n          matchesPlayed: number;\n        }\n      >();\n\n      // Inicializar estad√≠sticas para todas las parejas\n      for (const pair of pairs) {\n        pairStats.set(pair.id, {\n          gamesWon: 0,\n          setsWon: 0,\n          points: 0,\n          matchesPlayed: 0,\n        });\n      }\n\n      // Procesar cada partido finalizado y acumular estad√≠sticas\n      let processedMatches = 0;\n      for (const match of matches) {\n        if (match.is_finished) {\n          console.log(`üîÑ Procesando partido: ${match.id}`);\n          const games = await getGames(match.id);\n\n          if (games.length > 0) {\n            const stats = this.calculateMatchStatistics(match, games);\n\n            // Acumular estad√≠sticas para pareja 1\n            const pair1Stats = pairStats.get(match.pair1_id)!;\n            pair1Stats.gamesWon += stats.pair1GamesWon;\n            pair1Stats.setsWon += stats.pair1SetsWon;\n            pair1Stats.points += stats.pair1TotalPoints;\n            pair1Stats.matchesPlayed += 1;\n\n            // Acumular estad√≠sticas para pareja 2\n            const pair2Stats = pairStats.get(match.pair2_id)!;\n            pair2Stats.gamesWon += stats.pair2GamesWon;\n            pair2Stats.setsWon += stats.pair2SetsWon;\n            pair2Stats.points += stats.pair2TotalPoints;\n            pair2Stats.matchesPlayed += 1;\n\n            processedMatches++;\n          }\n        }\n      }\n\n      // Actualizar todas las parejas con sus estad√≠sticas acumuladas\n      console.log(\"üîÑ Actualizando estad√≠sticas acumuladas...\");\n      for (const pair of pairs) {\n        const stats = pairStats.get(pair.id);\n        if (stats) {\n          await updatePair(pair.id, {\n            games_won: stats.gamesWon,\n            sets_won: stats.setsWon,\n            points: stats.points,\n            matches_played: stats.matchesPlayed,\n          });\n          console.log(\n            `üìä Pareja ${pair.id}: ${stats.points} puntos, ${stats.setsWon} sets, ${stats.gamesWon} juegos`\n          );\n        }\n      }\n\n      console.log(\n        `‚úÖ Estad√≠sticas recalculadas para ${processedMatches} partidos`\n      );\n      console.log(\"üîÑ === FIN REC√ÅLCULO ===\");\n\n      return {\n        success: true,\n        message: `‚úÖ Estad√≠sticas recalculadas exitosamente para ${processedMatches} partidos`,\n      };\n    } catch (error) {\n      console.error(\"‚ùå Error en recalculateAllStatistics:\", error);\n      return {\n        success: false,\n        message: \"Error al recalcular estad√≠sticas del torneo\",\n      };\n    }\n  }\n\n  /**\n   * Calcula el ranking de las parejas\n   */\n  static calculateRanking(pairs: Pair[]): Pair[] {\n    return [...pairs].sort((a, b) => {\n      // Criterio 1: Puntos totales (descendente) - CRITERIO PRINCIPAL\n      if (a.points !== b.points) {\n        return b.points - a.points;\n      }\n      // Criterio 2: Sets ganados (descendente) - CRITERIO DE DESEMPATE\n      if (a.sets_won !== b.sets_won) {\n        return b.sets_won - a.sets_won;\n      }\n      // Criterio 3: Juegos ganados (descendente)\n      if (a.games_won !== b.games_won) {\n        return b.games_won - a.games_won;\n      }\n      // Criterio 4: Menos partidos jugados (mejor eficiencia)\n      return a.matches_played - b.matches_played;\n    });\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}